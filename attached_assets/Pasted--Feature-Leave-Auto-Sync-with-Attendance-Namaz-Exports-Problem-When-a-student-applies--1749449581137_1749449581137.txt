ğŸ“Œ Feature: Leave Auto-Sync with Attendance, Namaz & Exports

ğŸ¯ Problem:
When a student applies for leave:
- It doesnâ€™t instantly reflect in Attendance if attendance is already partially taken.
- Namaz tracking ignores leave status completely.
- Leave data is missing from Excel exports.

ğŸ› ï¸ Solution Plan:

1. ğŸ§© Shared Utility Logic
- Create a reusable function `isOnLeave(studentId, date, leaveData)`
- This function checks if the given student has an active leave on the selected date.

```js
function isOnLeave(studentId, date, leaveRecords) {
  return leaveRecords.some(record => {
    const from = new Date(record.fromDate);
    const to = new Date(record.toDate);
    const current = new Date(date);
    return record.studentId === studentId && current >= from && current <= to;
  });
}
âœ… Attendance UI

Before rendering students, fetch all active leaves for the day.

Run isOnLeave() for each student and if true:

Show ğŸŸ¡ â€œOn Leaveâ€ badge.

Disable attendance toggle for that period.

If leave is applied mid-day, update upcoming periods automatically.

ğŸ•Œ Namaz Tracking UI

Before rendering namaz list, load leave records for today.

Run isOnLeave() and:

Show â€œOn Leaveâ€ banner like attendance.

Disable prayer marking for that student.

ğŸ“¤ Excel Export

While generating the Excel:

If student was on leave, set "L" or "On Leave" in the cell.

Apply yellow background to leave-marked cells.

Sync both Attendance + Namaz exports to show accurate leave info.

ğŸš« Leave Conflict Prevention

Before adding new leave:

js
Copy
Edit
function isDuplicateLeave(studentId, from, to, existing) {
  return existing.some(leave => {
    const lf = new Date(leave.fromDate), lt = new Date(leave.toDate);
    const nf = new Date(from), nt = new Date(to);
    return leave.studentId === studentId && (
      (nf <= lt && nf >= lf) || (nt <= lt && nt >= lf) || (nf <= lf && nt >= lt)
    );
  });
}
If conflict, show: â—â€œLeave already applied for this date range.â€

ğŸ” Sync Feedback

When leave is applied, show toast:

js
Copy
Edit
âœ… Leave reflected in attendance and namaz tracking.
ğŸ§ª Test Scenarios:

Apply leave for today â†’ Refresh attendance â†’ "On Leave" badge should show.

Apply leave after 1st period taken â†’ 2nd/3rd auto-marked "On Leave".

Namaz screen shows same banner & disables toggles.

Export shows â€œLâ€ or â€œLeaveâ€ cells for that student.

ğŸ“¦ Final Result:

All modules reflect leave in real-time.

No more manual marking errors.

Export files are accurate for record-keeping.